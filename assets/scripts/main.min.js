function formatGrid(){var portraits=[],landscapes=[],loop=document.getElementsByClassName("loop")[0];alert(loop);for(var list=loop.children,i=0;i<list.length;i++)isPortrait(list[i])?portraits.push(list[i]):landscapes.push(list[i]);portraits.length>0&&resizePortraitItems(portraits,landscapes[0]),addContentToColumns(loop,portraits.length)}function isPortrait(item){var img=item.getElementsByTagName("img")[0];return img.height>img.width}function resizePortraitItems(portraits,reference){refHeight=Math.floor(reference.clientHeight/5),portraits.forEach(function(item,index){var itemImg=item.getElementsByTagName("img")[0];item.currentStyle||window.getComputedStyle(item),itemImg.currentStyle||window.getComputedStyle(itemImg);item.style.maxHeight=2*refHeight+1+"px"})}function addContentToColumns(parent,nrPortrait){for(var rows=Math.ceil((parent.children.length+nrPortrait)/5),i=0;i<5;i++)if(column=createColumn(),parent.appendChild(column),!isColumn(parent.firstElementChild))for(j=0;j<rows&&(j==rows-2&&(item=parent.firstElementChild,newItem=item.nextElementSibling,!isPortrait(item)&&isPortrait(newItem)&&parent.insertBefore(newItem,item)),!isColumn(parent.firstElementChild));)item=parent.firstElementChild,column.appendChild(item),j++,isPortrait(item)&&j++}function createColumn(){var el=document.createElement("div");return el.setAttribute("class","loop-column"),el}function isColumn(item){return"DIV"==item.nodeName&&"loop-column"==item.className}function formatGrid(){var portraits=[],landscapes=[],loop=document.getElementsByClassName("loop")[0];alert(loop);for(var list=loop.children,i=0;i<list.length;i++)isPortrait(list[i])?portraits.push(list[i]):landscapes.push(list[i]);portraits.length>0&&resizePortraitItems(portraits,landscapes[0]),addContentToColumns(loop,portraits.length)}function isPortrait(item){var img=item.getElementsByTagName("img")[0];return img.height>img.width}function resizePortraitItems(portraits,reference){refHeight=Math.floor(reference.clientHeight/5),portraits.forEach(function(item,index){var itemImg=item.getElementsByTagName("img")[0];item.currentStyle||window.getComputedStyle(item),itemImg.currentStyle||window.getComputedStyle(itemImg);item.style.maxHeight=2*refHeight+1+"px"})}function addContentToColumns(parent,nrPortrait){for(var rows=Math.ceil((parent.children.length+nrPortrait)/5),i=0;i<5;i++)if(column=createColumn(),parent.appendChild(column),!isColumn(parent.firstElementChild))for(j=0;j<rows&&(j==rows-2&&(item=parent.firstElementChild,newItem=item.nextElementSibling,!isPortrait(item)&&isPortrait(newItem)&&parent.insertBefore(newItem,item)),!isColumn(parent.firstElementChild));)item=parent.firstElementChild,column.appendChild(item),j++,isPortrait(item)&&j++}function createColumn(){var el=document.createElement("div");return el.setAttribute("class","loop-column"),el}function isColumn(item){return"DIV"==item.nodeName&&"loop-column"==item.className}document.addEventListener("DOMContentLoaded",formatGrid);var ImageRowsToColumns={settings:{rows:2,columns:5},vars:{loop:document.getElementsByClassName("loop")[0],list:document.getElementsByClassName("loop")[0].children,portraits:[],landscapes:[]},init:function(){this.settings.columns=this.vars.loop.getAttribute("data-column"),this.settings.rows=Math.ceil(this.vars.list.length/this.settings.columns),this.runJS()},runJS:function(){this.separateTypes(),this.resizePortraits(),this.addColumns(),this.rowsToColumns()},isPortrait:function(el){var img=el.getElementsByTagName("img")[0];return img.height>img.width},isColumn:function(el){return"DIV"==el.nodeName&&"loop-column"==el.className},createColumn:function(){var el=document.createElement("div");return el.setAttribute("class","loop-column"),el.style.width=100/this.settings.columns+"%",el},separateTypes:function(){listArr=Array.from(this.vars.list),listArr.forEach(function(item,index){ImageRowsToColumns.isPortrait(item)?ImageRowsToColumns.vars.portraits.push(item):ImageRowsToColumns.vars.landscapes.push(item)})},resizePortraits:function(){this.vars.portraits.length>0&&(reference=this.vars.landscapes[0],refHeight=Math.floor(reference.clientHeight/this.settings.columns),this.vars.portraits.forEach(function(item,index){itemStyle=item.currentStyle||window.getComputedStyle(item),item.style.maxHeight=2*refHeight+1+"px"}))},addColumns:function(){parent=this.vars.loop;for(var i=0;i<this.settings.columns;i++)column=this.createColumn(),parent.appendChild(column)},rowsToColumns:function(){parent=this.vars.loop,children=this.vars.list,columns=document.getElementsByClassName("loop-column"),loopLength=children.length-columns.length;for(var i=0;i<loopLength;i++)item=parent.firstElementChild}};!function(){ImageRowsToColumns.init()}(),function(){"use strict";FeedReader.init()}(),document.addEventListener("DOMContentLoaded",formatGrid);